# .htaccess COMPATIBLE CON MAGIC CACHE
# Tres Monos Ink - www.tresmonosink.com
# Configuración que NO entra en conflicto con Magic Cache

# ===============================================
# SEGURIDAD Y PROTECCIÓN
# ===============================================

# Prevenir listado de directorios
Options -Indexes

# Proteger archivos sensibles
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# ===============================================
# REDIRECCIONES SIMPLIFICADAS (compatible con Magic Cache)
# ===============================================

# IMPORTANTE: Si usas Magic Cache de cPanel, este debe estar ANTES de cualquier otra regla
RewriteEngine On
RewriteBase /

# Redirección HTTPS + WWW simplificada (compatible con Magic Cache)
# NOTA: También puedes usar la opción "Force HTTPS" de cPanel en lugar de estas reglas

# Forzar HTTPS
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Forzar WWW
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^ https://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redireccionar index.html a raíz
RewriteCond %{THE_REQUEST} /index\.html [NC]
RewriteRule ^(.*)index\.html$ /$1 [R=301,L,NC]

# Error 404 personalizado
ErrorDocument 404 /404.html

# ===============================================
# COMPRESIÓN GZIP
# ===============================================

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/css text/javascript application/javascript application/x-javascript text/xml application/xml text/plain
</IfModule>

# ===============================================
# TIPOS MIME
# ===============================================

<IfModule mod_mime.c>
    AddType image/webp .webp
    AddType image/avif .avif
    AddType font/woff2 .woff2
</IfModule>

# ===============================================
# SEGURIDAD ADICIONAL
# ===============================================

<IfModule mod_headers.c>
    # Prevenir clickjacking
    Header always set X-Frame-Options "SAMEORIGIN"
    
    # XSS Protection
    Header always set X-XSS-Protection "1; mode=block"
    
    # Prevenir MIME type sniffing
    Header always set X-Content-Type-Options "nosniff"
</IfModule>

# ===============================================
# CHARSET
# ===============================================

AddDefaultCharset UTF-8

# ===============================================
# NOTA IMPORTANTE SOBRE CACHÉ
# ===============================================
# Si usas Magic Cache, NO incluimos reglas de caché aquí
# Magic Cache se encarga de la caché automáticamente
# Si desactivas Magic Cache, añade las reglas de caché del .htaccess principal

